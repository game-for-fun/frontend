<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ball.dao.CardDao">
	<resultMap id="BaseResultMap" type="com.ball.bean.Card">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="user_id" property="userId" jdbcType="INTEGER" />
		<result column="character_id" property="characterId" jdbcType="INTEGER" />
		<result column="character_name" property="characterName" jdbcType="VARCHAR" />
		<result column="character_lv" property="characterLv" jdbcType="INTEGER" />
		<result column="character_stars" property="characterStars" jdbcType="INTEGER" />
		<result column="character_pieces" property="characterPieces" jdbcType="INTEGER" />
		<result column="character_pic" property="characterPic" jdbcType="VARCHAR" />
		<result column="score" property="score" jdbcType="INTEGER" />
	</resultMap>

	<select id="getCardByCNameAndUId" resultMap="BaseResultMap">
		SELECT * FROM card WHERE character_name = #{characterName} AND user_id = #{userId}
	</select>

	<select id="getCardByUId" resultMap="BaseResultMap">
		SELECT * FROM card WHERE user_id = #{userId}
	</select>
	
	<insert id="addCard" parameterType="com.ball.bean.User">
		INSERT INTO card ( user_id,character_id,character_name,character_lv,character_stars,character_pieces,character_pic,score ) 
		VALUES ( #{userId},#{characterId},#{characterName},#{characterLv},#{characterStars},#{characterPieces},#{characterPic},1000 )
	</insert>

	<update id="updateCardPieces" parameterType="com.ball.bean.Card">
		UPDATE card SET character_pieces = #{characterPieces}
		WHERE id = #{id}
	</update>
	
	<select id="getById" resultMap="BaseResultMap">
		SELECT * FROM card WHERE id = #{cardId}
	</select>
	
	<update id="addStar" parameterType="com.ball.bean.Card">
		UPDATE card SET character_stars = #{characterStars},character_pieces = #{characterPieces}
		WHERE id = #{id}
	</update>
	
	<select id="getCountByUserAndStars" resultType="java.lang.Integer">
		SELECT count(*) FROM card WHERE user_id = #{userId} AND character_stars = #{characterStars}
	</select>
	
</mapper>