<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ball.dao.UserRmbRecordDao">
	<resultMap id="BaseResultMap" type="com.ball.bean.UserRmbRecord">
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="user_id" property="userId" jdbcType="INTEGER" />
		<result column="character_pic" property="characterPic" jdbcType="VARCHAR" />
		<result column="pic_index" property="picIndex" jdbcType="INTEGER" />
		<result column="huodong_type" property="huodongType" jdbcType="INTEGER" />
		<result column="get_rmb" property="getRmb" jdbcType="VARCHAR" />
		<result column="create_time" property="createTime" jdbcType="DATE" />
	</resultMap>

	<select id="getUserRmbRecordByUserId" resultMap="BaseResultMap">
		SELECT * FROM user_rmb_record WHERE user_id = #{userId}
	</select>
	
	<insert id="addUserRmbRecord" parameterType="com.ball.bean.UserRmbRecord">
		INSERT INTO user_rmb_record ( user_id,character_pic,pic_index,huodong_type,get_rmb,create_time ) 
		VALUES ( #{userId},#{characterPic},#{picIndex},#{huodongType},#{getRmb},#{createTime} )
	</insert>
	
	<select id="getRecordsByHuodongTypeAndDate" resultMap="BaseResultMap">
		SELECT * FROM user_rmb_record where huodong_type = 2 AND user_id = #{userId} AND date(create_time) = curdate() ORDER BY pic_index
	</select>
	
	<select id="getRecordByPicIndex" resultMap="BaseResultMap">
		SELECT * FROM user_rmb_record where pic_index = #{picIndex} AND user_id = #{userId} AND huodong_type = 2 AND date(create_time) = curdate()
	</select>
	
	<select id="getRecords2PicCountByUIdAndPicAndDate" resultMap="BaseResultMap">
		SELECT * FROM user_rmb_record where huodong_type = 2 
		AND user_id = #{userId} 
		AND character_pic = #{characterPic}
		AND date(create_time) = curdate()
	</select>
	
</mapper>